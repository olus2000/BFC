[

: call +- ;

: M ++- ;

: drop []- ;

: dip <+-

: swap []<<+-

: nip [ drop ] dip

: tuck + [ swap ] dip

: -rot [ swap ] > dip

: rot [ swap ] dip swap

: 2dup []>>+ dip call

: 0 [ []- ] ;

: 2 [ + dip call ] ;

: 10 [ + dip + dip + dip + dip + dip
  + dip + dip + dip + dip call ] ;

: 48 [ + dip + dip + dip + dip + dip
  + dip + dip + dip + dip + dip
  + dip + dip + dip + dip + dip
  + dip + dip + dip + dip + dip
  + dip + dip + dip + dip + dip
  + dip + dip + dip + dip + dip
  + dip + dip + dip + dip + dip
  + dip + dip + dip + dip + dip
  + dip + dip + dip + dip + dip
  + dip + dip call ] ;

: 1+ [ [ + dip ] dip call ] > ;

: add [ [ 1+ ] ] dip call ;

: 1- [ 0 0 [ nip + 1+ ] ] dip call drop ;

: sub [ [ 1- ] ] dip call ;

: true [ nip ] ;

: false [ drop ] ;

: * 0 flip [ add ] > swap call ;

: 0= true swap [ drop false ] swap call ;

: leq sub 0= ;

: if rot call call ;

: divmod
  [ [ 0 ] dip 1+ ] dip
  [ -rot 2dup sub 0=
    [ drop nip ]
    [ tuck sub swap
      [ [ [ 1+ ] dip ] dip swap ]
      dip swap M ] if ] M 1- ;

: read-decimal 0
  [ , + 10 leq
    [ drop drop ]
    [ 48 sub [ [ 10 * ] dip add ] > dip M ] if
  ] M ;

: print-nonzero-decimal
  [ swap + 0=
    [ drop drop ]
    [ 10 divmod
      flip M
      48 add . ] if ] M ;

: print-decimal 
  + 0=
  [ drop 48 . ]
  [ print-nonzero-decimal ] if ;

: main read-decimal 2 * print-decimal ;

][]-

[

: call +- ;

: M ++- ;

: drop []- ;

: dip <+-

: swap []<<+-

: nip [ []- ] <+-

: tuck + [ []<<+- ] <+-

: -rot [ []<<+- ] > <+-

: rot []>><+- (updated later so another version is actually in code)

: 2dup []>>+ <+- +-

: 0 [ []- ] ;

: 2 [ + <+- +- ] ;

: 10 [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- +- ] ;

: 48 [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- +- ] ;

: 1+ [ [ + <+- ] <+- +- ] > ;

: add [ [ [ [ + <+- ] <+- +- ] > ] ] <+- +- ;

: 1- [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ;

: sub [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- ;

: true [ [ []- ] <+- ] ;

: false [ []- ] ;

: * [ [ []- ] ]<<+- [ [ [ [ [ + <+- ] <+- +- ] > ] ] <+- +- ]> []<<+-
    +- ;

: 0= [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +- ;

: leq [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +- ;

: if []<<<+- +- +- ;

: divmod
  [ [ [ []- ] ] <+- [ [ + <+- ] <+- +- ] > ] <+-
  [ [ []<<+- ] > <+- []>>+ <+- +- [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
    [ []- [ []- ] <+- ]
    [ + [ []<<+- ] <+- [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- []<<+-
      [ [ [ [ [ + <+- ] <+- +- ] > ] <+- ] <+- []<<+- ]
      <+- []<<+- ++- ] []<<<+- +- +- ] ++- [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ;

: read-decimal [ []- ]
  [ , + [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- +- ] [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
    [ []- []- ]
    [ [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- +- ] [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- [ [ [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- +- ] [ [ []- ] ]<<+- [ [ [ [ [ + <+- ] <+- +- ] > ] ] <+- +- ]> []<<+- +- ] <+- [ [ [ [ + <+- ] <+- +- ] > ] ] <+- +- ] > <+- ++- ] []<<<+- +- +-
  ] ++- ;

: print-nonzero-decimal
  [ []<<+- + [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
    [ []- []- ]
    [ [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- +- ] [ [ [ []- ] ] <+- [ [ + <+- ] <+- +- ] > ] <+-
  [ [ []<<+- ] > <+- []>>+ <+- +- [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
    [ []- [ []- ] <+- ]
    [ + [ []<<+- ] <+- [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- []<<+-
      [ [ [ [ [ + <+- ] <+- +- ] > ] <+- ] <+- []<<+- ]
      <+- []<<+- ++- ] []<<<+- +- +- ] ++- [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []-
      []<<<+- ++-
      [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- +- ] [ [ [ [ + <+- ] <+- +- ] > ] ] <+- +- . ] []<<<+- +- +- ] ++- ;

: print-decimal 
  + [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
  [ []- [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- +- ] . ]
  [ [ []<<+- + [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
    [ []- []- ]
    [ [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- +- ] [ [ [ []- ] ] <+- [ [ + <+- ] <+- +- ] > ] <+-
  [ [ []<<+- ] > <+- []>>+ <+- +- [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
    [ []- [ []- ] <+- ]
    [ + [ []<<+- ] <+- [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- []<<+-
      [ [ [ [ [ + <+- ] <+- +- ] > ] <+- ] <+- []<<+- ]
      <+- []<<+- ++- ] []<<<+- +- +- ] ++- [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []-
      []<<<+- ++-
      [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- +- ] [ [ [ [ + <+- ] <+- +- ] > ] ] <+- +- . ] []<<<+- +- +- ] ++- ] []<<<+- +- +- ;

: main [ []- ]
  [ , + [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- +- ] [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
    [ []- []- ]
    [ [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- +- ] [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- [ [ [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- +- ] [ [ []- ] ]<<+- [ [ [ [ [ + <+- ] <+- +- ] > ] ] <+- +- ]> []<<+- +- ] <+- [ [ [ [ + <+- ] <+- +- ] > ] ] <+- +- ] > <+- ++- ] []<<<+- +- +-
  ] ++- [ +<+- +- ] [ [ []- ] ]<<+- [ [ [ [ [ + <+- ] <+- +- ] > ] ] <+- +- ]> []<<+- +- + [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
  [ []- [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- +- ] . ]
  [ [ []<<+- + [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
    [ []- []- ]
    [ [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- +- ] [ [ [ []- ] ] <+- [ [ + <+- ] <+- +- ] > ] <+-
  [ [ []<<+- ] > <+- []>>+ <+- +- [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- [ [ []- ] <+- ] []<<+- [ []- [ []- ] ] []<<+- +-
    [ []- [ []- ] <+- ]
    [ + [ []<<+- ] <+- [ [ [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []- ] ] <+- +- []<<+-
      [ [ [ [ [ + <+- ] <+- +- ] > ] <+- ] <+- []<<+- ]
      <+- []<<+- ++- ] []<<<+- +- +- ] ++- [ [ []- ] [ [] - ] [ [ []- ] <+- + [ [ + <+- ] <+- +- ] > ] ] <+- +- []-
      []<<<+- ++-
      [ + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- + <+- + <+- + <+-
       + <+- + <+- +- ] [ [ [ [ + <+- ] <+- +- ] > ] ] <+- +- . ] []<<<+- +- +- ] ++- ] []<<<+- +- +- ;

][]-

[[]-][,+[+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+-][[[[[]-][[]-][[[]-]<+-+[[+<+-]<+
-+-]>]]<+-+-[]-]]<+-+-[[[]-]<+-][]<<+-[[]-[[]-]][]<<+-+-[[]-[]-][[+<+-+<+-+<+-+<
+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<
+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<
+-+<+-+<+-+<+-+-][[[[[]-][[]-][[[]-]<+-+[[+<+-]<+-+-]>]]<+-+-[]-]]<+-+-[[[+<+-+<
+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+-][[[]-]]<<+-[[[[[+<+-]<+-+-]>]]<+-+-]>[]<<+-+-]<
+-[[[[+<+-]<+-+-]>]]<+-+-]><+-++-][]<<<+-+-+-]++-[+<+-+-][[[]-]]<<+-[[[[[+<+-]<+
-+-]>]]<+-+-]>[]<<+-+-+[[[]-]<+-][]<<+-[[]-[[]-]][]<<+-+-[[]-[+<+-+<+-+<+-+<+-+<
+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<
+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<
+-+<+-+<+-+-].][[[]<<+-+[[[]-]<+-][]<<+-[[]-[[]-]][]<<+-+-[[]-[]-][[+<+-+<+-+<+-
+<+-+<+-+<+-+<+-+<+-+<+-+-][[[[]-]]<+-[[+<+-]<+-+-]>]<+-[[[]<<+-]><+-[]>>+<+-+-[
[[[[]-][[]-][[[]-]<+-+[[+<+-]<+-+-]>]]<+-+-[]-]]<+-+-[[[]-]<+-][]<<+-[[]-[[]-]][
]<<+-+-[[]-[[]-]<+-][+[[]<<+-]<+-[[[[[]-][[]-][[[]-]<+-+[[+<+-]<+-+-]>]]<+-+-[]-
]]<+-+-[]<<+-[[[[[+<+-]<+-+-]>]<+-]<+-[]<<+-]<+-[]<<+-++-][]<<<+-+-+-]++-[[[]-][
[]-][[[]-]<+-+[[+<+-]<+-+-]>]]<+-+-[]-[]<<<+-++-[+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+
-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+
-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+<+-+-]
[[[[+<+-]<+-+-]>]]<+-+-.][]<<<+-+-+-]++-][]<<<+-+-+-
