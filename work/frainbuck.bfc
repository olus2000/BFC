: I Q @ ! - * / leq? ) emit getc pick

: , 0 @ ! 0 @ -0001 - . ! )

: ; I 72 , 42 86 01 ! 86 ! )

: ?ret 01 @ - -1 * 001 ! ;

: !ret 1 @ @ 1 @ 1 - 000001 ! 00001 @ ! ;

: dup 0 pick ;

: drop 0 * - ;

: + -01 * - ;

: over 1 pick ;

: nip over - + ;

: % over over / * - ;

: not leq? ;

: <= - leq? ;

: >= over <= nip ;

: lit, 2 , , ;

: = - dup leq? over -01 * leq? * nip ;

: >bool . = leq? ;

: >r I 1.1 lit, -1 48 , lit, 84 056 , 0 lit, , 0052 001 lit, 52 , , ;

: r> I 01.11 lit, 48.111 , 48 , 1.11 lit, 48 , 1.11 lit, 56 , 01.11 lit, 52 , ;

: swap over >r nip r> ;

: (variable); I 0 @ 3.11 + lit, 72.0111 , ;

: nl 10 emit ;

: big-alloc I . @ 21110 + . ! ;

: cp (variable); big-alloc

: dp (variable); big-alloc

: setup dp 01 + dp ! cp 1 + cp ! ;

: semicolon? getc dup 59 = not ?ret !ret drop ;

: compile? leq? ?ret !ret cp @ dup 001.1110 + cp ! ! ;

: command?
    dup 43.111 >= over 46.111 <= *
    over 60.111 = + over 62 = + over 91 = + over 93 = +
    compile? drop ;

: load-program; !ret semicolon? command? load-program;

: load-program load-program;

: finished? cp @ @ >bool ?ret !ret ;

: next cp @ @ cp @ 001.111 + cp ! ;

: exec+ dup 043 = not ?ret !ret drop dp @ @ 1.11 + dp @ ! ;

: exec- dup 045 = not ?ret !ret drop dp @ @ 1.11 - dp @ ! ;

: exec> dup 62 = not ?ret !ret drop dp @ 1.111 + dp ! ;

: exec< dup 60 = not ?ret !ret drop dp @ 1.111 - dp ! ;

: exec, dup 44.1111 = not ?ret !ret drop getc dp @ ! ;

: exec. dup 46.0100001 = not ?ret !ret drop dp @ @ emit ;

: unmatched? leq? ?ret !ret ;

: close? dup 00093 = not ?ret !ret drop 001 - dup unmatched? drop !ret ;

: open? dup 91 = not ?ret !ret drop 1 + ;

: handle close? open? drop ;

: seek; !ret next handle seek;

: seek? dp @ @ >bool ?ret !ret 1 seek;

: exec[ dup 0091 = not ?ret !ret drop seek? cp @ ;

: loop? . = ?ret !ret dup cp ! ;

: exec] dup 93 = not ?ret !ret drop dp @ @ loop? drop ;

: exec exec+ exec- exec> exec< exec, exec. exec[ exec] drop ;

: run-program; !ret finished? next exec run-program;

: main I setup load-program setup run-program; ; main

001111001111100010000100011001111110011111001111100111110011111100010000100011000000001100110011001100110011100111001100110011001100110011001110011001100110011100111001100110011100111001110011100110011001100110011001110011001100110011001110011001100110011100111001100110011100111001110011100110011001100110011001110011001100110011001110011001100110011100111001100110011100111001110011001100111001110011100110011001110011100111001100110011100111001110011100110011001110011100111001110011001100111001110011100111001100110011100111001110011100110011001110011100111001100110011100111001110011100110011001110011100111001110011001100111001110011100111001100110011100111001110011001100111001110011100110011001110011100111001110011001100111001110011100111001100110011100111001110011100110011001110011100111001110011001100111001110011100111001100110011100111001110011100110011001110011100111001110011001100110011100110011001100110011100110011001100111001110011001100111001110011100111001110011001100111001110011100111001100110011100111001110011100110011001110011100111001110011100110011001100111001100110011001100111001100110011001110011100110011001110011100111001110011100111001100110011100111001110011100111001100110011100111001110011100111001100110011100111001110011100111001100110011100111001110011100111001110011001100110011100110011001100110011100110011001100111001110011001100110011001100110011011100001000110000000011100111001110011001100110011001110011001100110011100111001100111001110011100111001110011100111001110011001100111001100110011001110011100110011100111001110011100111001110011100110011001110011100111001100110011100110011001100111001110011001110011100111001110011100110011001110011001100110011100111001100111001110011100111001100110011100111001110011001100111001110011100111001110011100110011001110011001100110011100111001100111001110011100111001110011001100111001100110011001110011100110011100111001110011100110011001110011100110011001110011001100110011100111001100111001110011100111001110011100111001110011001100111001100110011001110011100110011100111001110011100111001110011100110011001110011100110011001100111001100110111000010001101111111100100011011111110011100100011011111001000110111100111001111110010001101111100100011011110011001000110111111110010001101111111001100010a
