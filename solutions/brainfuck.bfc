: I Q @ ! - * / leq? ; emit getc pick

: reset 000001.1 @ @ 000086 1 ! 86 ! ;
: | I 01.1 @ @ 86 1.111 ! 86 ! ;

: dup 0 pick ;
: over 001 pick ;
: swap 00003 ! 4 ! 003.1 @ 4 @ ;
: drop 0 * - ;
: nip swap drop ;

: <= - leq? ;
: >= swap <= ;
: = - dup leq? swap -1 * leq? * ;

: + -1 * - ;

: ?ret leq? 1 @ - -1 * 000001 ! ;

: , . @ ! . @ 00001 + . ! ;

|

: +? dup @ 0043 = ?ret . @ @ 1 + . @ ! ;
: -? dup @ 045 = ?ret . @ @ 1.1 - . @ ! ;
: >? dup @ 62 = ?ret . @ 1.11 + . ! ;
: <? dup @ 60 = ?ret . @ 1.11 - . ! ;
: ,? dup @ 44.1111 = ?ret getc . @ ! ;
: .? dup @ 46 = ?ret . @ @ emit ;

|

: [-true? . @ @ . = leq? ?ret dup ;
: [-false? . @ @ . = ?ret 5 @ 1 + 5.10 ! ;
: [? dup @ 091 = ?ret [-true? [-false? ;

: ]-true? . @ @ . = leq? ?ret drop dup ;
: ]-false? . @ @ . = ?ret nip ;
: ]? dup @ 93 = ?ret ]-true? ]-false? ;

: [-skip? dup @ 0091 = ?ret 5 @ 1 + 005 ! ;
: ]-skip? dup @ 93 = ?ret 005 @ 1 - 5 ! ;

|

: exec?
  5 @ 001 <= ?ret . 5 !
  +? -? >? <? ,? .? [? ]? ;

: skip? 5 @ 1.001 >= ?ret [-skip? ]-skip? ;

: finished? dup @ leq? ?ret Q Q
: exec-loop; finished? exec? skip? 1 + reset exec-loop;

|

: ;? dup 59 = ?ret drop 0.01110 , exec-loop;

: bf-com?
  dup 43.11 >= over 46.1111 <= *
  over 62.1111 = + over 60 = +
  over 91 = + over 93 = +
  ?ret dup , ;

: load-program; getc ;? bf-com? drop reset load-program;

: main I 0 @ load-program; main

01111001111001111001111000100001000110011111001111001111001111100010000100011001111110011111001111100111110011111100010000100011000000001100110011001100110011100111001100110011001100110011001110011001100110011100111001100110011100111001110011100110011001100110011001110011001100110011001110011001100110011100111001100110011100111001110011100110011001100110011001110011001100110011001110011001100110011100111001100110011100111001110011001100111001110011100110011001110011100111001100110011100111001110011100110011001110011100111001110011001100111001110011100111001100110011100111001110011100110011001110011100111001100110011100111001110011100110011001110011100111001110011001100111001110011100111001100110011100111001110011001100111001110011100110011001110011100111001110011001100111001110011100111001100110011100111001110011100110011001110011100111001110011001100111001110011100111001100110011100111001110011100110011001110011100111001110011001100110011100110011001100110011100110011001100111001110011001100111001110011100111001110011001100111001110011100111001100110011100111001110011100110011001110011100111001110011100110011001100111001100110011001100111001100110011001110011100110011001110011100111001110011100111001100110011100111001110011100111001100110011100111001110011100111001100110011100111001110011100111001100110011100111001110011100111001110011001100110011100110011001100110011100110011001100111001110011001100110011001100110011011100001000110000000011100111001110011001100110011001110011001100110011100111001100111001110011100111001110011100111001110011001100111001100110011001110011100110011100111001110011100111001110011100110011001110011100111001100110011100110011001100111001110011001110011100111001110011100110011001110011001100110011100111001100111001110011100111001100110011100111001110011001100111001110011100111001110011100110011001110011001100110011100111001100111001110011100111001110011001100111001100110011001110011100110011100111001110011100110011001110011100110011001110011001100110011100111001100111001110011100111001110011100111001110011001100111001100110011001110011100110011100111001110011100111001110011100110011001110011100110011001100111001100110111000010001101111111100100011011111110011100100011011111001000110111100111001111110010001101111100100011011110011001000110111111110010001101111111001100010
